<!doctype html>
<html>
  <head>
    <title>Embetter</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <link rel="icon" href="./favicon.ico" />
    <link rel="stylesheet" href="./vendor/pico.min.css" />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
      }
      .container {
        max-width: 660px;
        width: 90%;
        margin-top: 40px;
      }
      embetter-media {
        margin-bottom: 1rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Embetter</h1>
      <h5>Because iframes are janky.</h5>
      <p>
        Media embeds can quickly bog your site down, so let's lazy-load them! The basic Embetter player consists of a
        tiny template with a progressively-enhanced thumbnail image, a play button, and the essential data needed to
        construct the responsive iframe embed code. Add a dash of javascript &amp; css to your web page, and you have a
        simple, lightweight media player.
      </p>
      <p>Find the <a href="https://github.com/cacheflowe/embetter">Embetter code &amp; instructions on GitHub</a>.</p>

      <div class="row">
        <div class="twelve columns">
          <label for="pasteMediaUrl">Paste a media URL to build an Embetter player:</label>
          <input
            type="text"
            placeholder="YouTube, Vimeo, Instagram, SoundCloud, Giphy, Shadertoy, Mixcloud, Dailymotion, Kuula, CodePen, or Bandcamp URL"
            id="pasteMediaUrl"
          />
        </div>
      </div>

      <div id="new-embeds"></div>

      <h3>YouTube</h3>
      <embetter-media youtube-id="l9XdkPsaynk"
        ><a href="https://www.youtube.com/watch?v=l9XdkPsaynk"
          ><img src="http://img.youtube.com/vi/l9XdkPsaynk/0.jpg" /></a
      ></embetter-media>

      <h3>Vimeo</h3>
      <embetter-media vimeo-id="99276873"
        ><a href="https://vimeo.com/99276873"
          ><img
            src="https://i.vimeocdn.com/video/480405928-48d6aa0161af27e47a14177e7d791cbad2ae022e21321786c58c81e14bfee75c-d_640?region=us" /></a
      ></embetter-media>

      <h3>Video (local)</h3>
      <embetter-media video-url="sample-data/nike-re-creation-center-hovercraft-insta-06.mp4" loops
        ><a href="sample-data/nike-re-creation-center-hovercraft-insta-06.mp4"
          ><img src="sample-data/nike-re-creation-center-hovercraft-insta-06.jpg" /></a
      ></embetter-media>

      <h3>gif (local)</h3>
      <embetter-media gif-url="sample-data/cacheflowe-halftone-cubes.gif"
        ><a href="sample-data/cacheflowe-halftone-cubes.gif"><img src="sample-data/cacheflowe-halftone-cubes.png" /></a
      ></embetter-media>

      <h3>SoundCloud</h3>
      <embetter-media soundcloud-id="swufm/dan-kelly-with-sinjin-hawke"
        ><a href="https://soundcloud.com/swufm/dan-kelly-with-sinjin-hawke"
          ><img src="https://i1.sndcdn.com/artworks-jqSa3k4AgYuSWxQS-BqSX3g-t500x500.jpg" /></a
      ></embetter-media>

      <h3>SoundCloud (set)</h3>
      <embetter-media soundcloud-id="cacheflowe/sets/das-werk"
        ><a href="https://soundcloud.com/cacheflowe/sets/das-werk"
          ><img src="https://i1.sndcdn.com/artworks-3DdyXPJbYORZrRoA-A0ciVg-t500x500.jpg" /></a
      ></embetter-media>

      <h3>Bandcamp</h3>
      <embetter-media bandcamp-id="album=462033739"
        ><a href="https://client03.bandcamp.com/album/testbed-assembly"
          ><img src="https://f4.bcbits.com/img/a2546679205_16.jpg" /></a
      ></embetter-media>

      <h3>Mixcloud</h3>
      <embetter-media
        mixcloud-id="Rumpel_Star/the-sound-of-the-eighties-7-a-funky-soulful-trip-through-the-80s-lost-treasures/"
        ><a
          href="https://www.mixcloud.com/Rumpel_Star/the-sound-of-the-eighties-7-a-funky-soulful-trip-through-the-80s-lost-treasures/"
          ><img
            src="https://thumbnailer.mixcloud.com/unsafe/600x600/extaudio/c/4/d/9/9235-5d20-4caf-8ec6-2f05c76dec34" /></a
      ></embetter-media>

      <h3>Dailymotion</h3>
      <embetter-media dailymotion-id="x14y6rv"></embetter-media>

      <h3>Giphy</h3>
      <embetter-media giphy-id="26FfiRH4zeXJM7saY"></embetter-media>

      <h3>CodePen</h3>
      <embetter-media codepen-id="cacheflowe/pen/domZpQ"></embetter-media>

      <p>&nbsp;</p>
    </div>

    <script type="module">
      import EmbetterMedia from "./src/embetter-media.js";

      function escapeHtml(str) {
        return str.replace(/</g, "&lt;").replace(/>/g, "&gt;");
      }

      function playerCode(htmlStr) {
        htmlStr = htmlStr.replace(/>\s+</g, "><");
        return "<p>Embed code:<textarea>" + escapeHtml(htmlStr) + "</textarea></p>";
      }

      var newEmbedsEl = document.getElementById("new-embeds");
      var pasteInput = document.getElementById("pasteMediaUrl");
      pasteInput.addEventListener("paste", function (e) {
        requestAnimationFrame(function () {
          EmbetterMedia.componentMarkupFromURL(pasteInput.value, (markup, service) => {
            let exampleMarkup = `
              <h3>${service.type.toUpperCase()}</h3>
              ${markup}
              ${playerCode(markup.trim())}
            `;
            newEmbedsEl.insertAdjacentHTML("afterbegin", exampleMarkup);
          });
          setTimeout(function () {
            pasteInput.value = "";
          }, 750);
        });
      });
    </script>
  </body>
</html>
